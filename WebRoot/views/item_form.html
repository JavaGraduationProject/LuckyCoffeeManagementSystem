<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>商品编辑页面</title>
    <script src="../layui/layui.js"></script>
    <link rel="stylesheet" href="../layui/css/layui.css">
    <script src="../js/jquery-1.11.3.min.js"></script>
    <style type="text/css">
        /*body{*/
        /*    text-align: center;*/
        /*}*/
        html, body {
            width: 100%;
            height: 99%;
        }
        .layui-form-label{
            width: 80px;
        }
        .layui-form-item{
            margin: 10px;
        }
        .item_pic{
            width: 100%;
            height: 120px;
            overflow-y: auto;
        }
        .item_pic img{
            width:100px;
            height: 100px;
            cursor: pointer;
        }
        .layui-field-box{
            padding: 0;
        }

    </style>
    <script src="js/util.js"></script>
</head>
<body>
<form class="layui-form layui-form-pane" action="" lay-filter="itemForm">
    <div class="layui-form-item">
        <label class="layui-form-label">名称</label>
        <div class="layui-input-inline">
            <input type="text" name="name"  placeholder="请输入" autocomplete="off" class="layui-input">
        </div>
        <label class="layui-form-label">品牌</label>
        <div class="layui-input-inline">
            <input type="text" name="brand"  placeholder="请输入" autocomplete="off" class="layui-input">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">产地</label>
        <div class="layui-input-inline">
            <select id="place" name="place" lay-verify="required">
                <option value=""></option>
            </select>
        </div>
        <label class="layui-form-label">包装</label>
        <div class="layui-input-inline">
            <select id="packet" name="packet" lay-verify="required">
                <option value=""></option>
            </select>
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">价格</label>
        <div class="layui-input-inline">
            <input type="text" name="price"  placeholder="请输入" autocomplete="off" class="layui-input">
        </div>
        <label class="layui-form-label">重量</label>
        <div class="layui-input-inline">
            <input type="text" name="weight"  placeholder="请输入" autocomplete="off" class="layui-input">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">数量</label>
        <div class="layui-input-inline">
            <input type="text" name="total"  placeholder="请输入" autocomplete="off" class="layui-input">
        </div>
        <label class="layui-form-label">图片</label>
        <div class="layui-input-inline">
            <input id="pic" type="text" name="pic" required  lay-verify="required" disabled placeholder="请选择下方图片" autocomplete="off" class="layui-input">
        </div>
    </div>
    <div class="layui-form-item">
        <fieldset class="layui-elem-field"> <legend style="font-size: 14px">选择图片</legend>
            <div class="layui-field-box">
                <div class="item_pic">
                    <img src="image/coffee1.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee2.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee3.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee4.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee5.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee6.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee7.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee8.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee9.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee10.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee11.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee12.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee13.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee14.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee15.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee16.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee17.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee18.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee19.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee20.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee21.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee22.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee23.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee24.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee25.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee26.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee27.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee28.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee29.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee30.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee31.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee32.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee33.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee34.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee35.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee36.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee37.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee38.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee39.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee40.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee41.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee42.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee43.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee44.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee45.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee46.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee47.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee48.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee49.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee50.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee51.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee52.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee53.png" title="点击选择图片" onclick="getPic(this);">
                    <img src="image/coffee54.png" title="点击选择图片" onclick="getPic(this);">
                </div>
            </div>
        </fieldset>

    </div>
    <div class="layui-form-item layui-form-text">
        <label class="layui-form-label">描述</label>
        <div class="layui-input-block">
            <textarea name="desc" placeholder="请输入内容" class="layui-textarea"></textarea>
        </div>
    </div>
<!--    <div class="layui-form-item">-->
<!--        <div class="layui-input-block">-->
<!--            <button class="layui-btn" lay-submit lay-filter="formDemo">立即提交</button>-->
<!--            <button type="reset" class="layui-btn layui-btn-primary">重置</button>-->
<!--        </div>-->
<!--    </div>-->
</form>
<script>
    //Demo
    var form;
    var baseUrl;
    var id;

    layui.use('form', function(){
        form = layui.form;
        baseUrl = getURL();

        id = getQueryString("id")==null?"":getQueryString("id");

        loadArea();
        loadPacket();
        loadForm();
        form.render();
        //监听提交
        form.on('submit(formDemo)', function(data){
            layer.msg(JSON.stringify(data.field));
            getData(data.field);
            return false;
        });
    });

    //加载地区下拉框数据
    function loadArea() {
        $.ajax({
            type: "post",
            url: baseUrl + "/sort",
            data: {"sort":"产地"},
            dataType: "json",
            async: false,
            success: function (data) {
                if (data.status) {
                    $.each(data.data,function (index,item) {
                        $('#place').append(new Option(item.sortValue, item.sortValue));// 下拉菜单里添加元素
                    });
                    form.render("select");
                }
            }
        });
    }

    //加载包装下拉框数据
    function loadPacket() {
        $.ajax({
            type: "post",
            url: baseUrl + "/sort",
            data: {"sort":"包装"},
            dataType: "json",
            async: false,
            success: function (data) {
                if (data.status) {
                    $.each(data.data,function (index,item) {
                        $('#packet').append(new Option(item.sortValue, item.sortValue));// 下拉菜单里添加元素
                    });
                    form.render("select");
                }
            }
        });
    }

    //加载表单
    function loadForm() {
        $.ajax({
            type: "post",
            url: baseUrl + "/getItem",
            data: {"id":id},
            dataType: "json",
            async: false,
            success: function (data) {
                if (data.status) {
                    //给表单赋值
                    form.val("itemForm", data.data);
                }
            }
        });

    }

    //获取表单的值
    function getData() {
        return form.val("itemForm");
    }

    //选择图片，获取图片名称
    function getPic(obj) {
        //获取当前点击对象的src属性值
        var src = obj.src;
        if(src != ""){
            //判断src属性值不为空时，则将路径中的项目基本路径 http://localhost:8080/luckycoffee/views/image/ 替换为空
            src = src.replace(baseUrl + "/views/image/","");
        }
        //将coffee6.png 部分赋值给 商品图片输入框的 value
        $("#pic").val(src);
    }
</script>
</body>
</html>